# npm

##  javascript åŒ…ç®¡ç†çš„å†å²
- npm å‡ºç°ä¹‹å‰ï¼šå‰ç«¯ä¾èµ–é¡¹æ˜¯ä¿å­˜åˆ°å­˜å‚¨åº“ä¸­å¹¶æ‰‹åŠ¨ä¸‹è½½çš„ğŸ“
- 2010ï¼šnpm å‘å¸ƒå¹¶æ”¯æŒ nodejsğŸ“¦
- 2012ï¼šnpm çš„ä½¿ç”¨é‡æ€¥å‰§å¢åŠ â€”â€”ä¸»è¦æ˜¯ç”±äº Browserifys æµè§ˆå™¨çš„æ”¯æŒğŸ‰
- 2012ï¼šnpm æœ‰äº†ä¸€ä¸ªç«äº‰å¯¹æ‰‹ bowerï¼Œå®ƒå®Œå…¨æ”¯æŒæµè§ˆå™¨ğŸ’»
- 2012-2016ï¼šå‰ç«¯é¡¹ç›®çš„ä¾èµ–é¡¹æ•°é‡æˆå€å¢åŠ ğŸ¤¯
- 2012-2016ï¼šæ„å»ºå’Œå®‰è£…å‰ç«¯åº”ç”¨å˜å¾—è¶Šæ¥è¶Šæ…¢ğŸ¢
- 2012-2016ï¼šå¤§é‡ï¼ˆé‡å¤çš„ï¼‰ä¾èµ–é¡¹å­˜å‚¨åœ¨ç¥å¥‡çš„ node_modules å†…çš„åµŒå¥—æ–‡ä»¶å¤¹ä¸­â˜¢ï¸
- 2012-2016ï¼šrm -rf node_modules æˆä¸ºå‰ç«¯å¼€å‘äººå‘˜æœ€å¸¸ç”¨çš„å‘½ä»¤ã€‚ ğŸ—‘
- 2015ï¼šbower è¾“ç»™äº† npm  ğŸ’€
- 2015ï¼šnode_modules è¢«ä¿®æ”¹ä¸ºæ‰å¹³åŒ–çš„æ–‡ä»¶ç»“æ„ï¼ ğŸ•¸
- 2016ï¼š left-padæˆä¸ºå½“æ—¶çš„æ–°é—»å¤´æ¡ ğŸ‘ˆ
- 2016ï¼š yarn å‘å¸ƒ ğŸš€
  - æ”¯æŒ npm å’Œ bower ä»“åº“
  - yarn.lock èƒ½å¤Ÿé”å®šå®‰è£…çš„ç‰ˆæœ¬å¹¶æä¾›ç¡®å®šæ€§çš„ä¾èµ–å…³ç³»ã€‚ä¸å† rm -rf - node_modulesï¼
  - yarn install èŠ±è´¹çš„æ—¶é—´æ˜¯ npm install çš„ä¸€åŠï¼ˆä¸ä½¿ç”¨ç¼“å­˜çš„å‰æä¸‹ï¼‰
  - ç¼“å­˜å’Œè„±æœºæ¨¡å¼ä½¿æ„å»ºè¿‡ç¨‹å‡ ä¹ä¸èŠ±è´¹æ—¶é—´
- 2016ï¼šnpm å‘å¸ƒ shrinkwrapğŸ§¯
  - å°è¯•å¤„ç†ä¾èµ–é¡¹é”å®š
  - ä¸å¹¸çš„æ˜¯ï¼Œä¸€äº›é”™è¯¯å’Œè¶…å‡ºå…¶ç®¡ç†èƒ½åŠ›çš„æ‰¿è¯ºå¯¼è‡´è¯¥å·¥å…·çš„å£°èª‰ä¸‹é™
- 2017ï¼šnpm 5 å‘å¸ƒğŸ”“
  - package-lock.json æ˜¯ä»–ä»¬çš„æ–°å·¥å…·ï¼Œshrinkwrap è¢«æ”¾åœ¨ä¸€è¾¹
  - package-lock.json å¼€å§‹ä¸ yarns é”å®šæ–‡ä»¶ç«äº‰


- 2018ï¼šnpm ci å‘å¸ƒğŸ›¬
  - ç›´æ¥ç”¨ package-lock.json æ„å»ºä»£ç 
  - æ²¡æœ‰ä»£ä»·é«˜æ˜‚çš„ä¾èµ–é¡¹å®‰å…¨æ€§åˆ†æå’Œç‰ˆæœ¬åˆ†æ
  - å¤§å¤§å‡å°‘äº†åœ¨æ„å»ºæœåŠ¡å™¨ä¸Šçš„æ„å»ºæ—¶é—´ï¼
- 2018ï¼šnpm 6 å‘å¸ƒğŸ‘®â€â™€ï¸
  - npm æ£€æŸ¥è¦å®‰è£…çš„ä¾èµ–é¡¹ä¸­çš„å®‰å…¨æ¼æ´
  - yarn å’Œ npm çš„æ„å»ºæ—¶é—´ä¸å†æœ‰æ˜¾å·®å¼‚
- 2019ï¼štink å¼€å§‹è¿›å…¥ beta æ¨¡å¼ğŸ¦‹
  - é¿å…ä½¿ç”¨ node_modulesï¼Œè€Œæ˜¯ä¸ºé¡¹ç›®ä¸­çš„æ¯ä¸ªä¾èµ–é¡¹åˆ›å»ºä¸€ä¸ªå¸¦æœ‰å“ˆå¸Œå€¼çš„æ–‡ä»¶
  - å°šæœªåšå¥½æŠ•å…¥ç”Ÿäº§ç¯å¢ƒçš„å‡†å¤‡
- ...

## æ—©æœŸçš„npm

å…¶å®åœ¨æœ€æ—©æœŸçš„`npm`ç‰ˆæœ¬(npm v2)ï¼Œ`npm`çš„è®¾è®¡å¯ä»¥è¯´æ˜¯éå¸¸çš„ç®€å•,åœ¨å®‰è£…ä¾èµ–çš„æ—¶å€™ä¼šå°†ä¾èµ–æ”¾åˆ°` node_modules`æ–‡ä»¶ä¸­; åŒæ—¶,å¦‚æœæŸä¸ªç›´æ¥ä¾èµ–Aä¾èµ–äºå…¶ä»–çš„ä¾èµ–åŒ…B,é‚£ä¹ˆä¾èµ–Bä¼šä½œä¸ºé—´æ¥ä¾èµ–,å®‰è£…åˆ°ä¾èµ–Açš„æ–‡ä»¶å¤¹`node_modules`ä¸­,ç„¶åå¯èƒ½å¤šä¸ªåŒ…ä¹‹é—´ä¹Ÿä¼šæœ‰å‡ºç°åŒæ ·çš„ä¾èµ–é€’å½’çš„,å¦‚æœé¡¹ç›®ä¸€æ—¦è¿‡å¤§,é‚£ä¹ˆå¿…ç„¶ä¼šå½¢æˆä¸€æ£µå·¨å¤§çš„ä¾èµ–æ ‘ï¼Œä¾èµ–åŒ…ä¼šå‡ºç°é‡å¤,å½¢æˆ`åµŒå¥—åœ°ç‹±`ã€‚

### é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•å»ç†è§£"åµŒå¥—åœ°ç‹±"å‘¢ï¼Ÿ
- é¦–å…ˆ,é¡¹ç›®çš„ä¾èµ–æ ‘çš„å±‚çº§è¿‡äºæ·±ï¼Œå¦‚æœæœ‰é—®é¢˜ä¸åˆ©äºæ’æŸ¥å’Œè°ƒè¯•
- åœ¨ä¾èµ–çš„åˆ†æ”¯ä¸­,å¯èƒ½ä¼šå‡ºç°åŒæ ·ç‰ˆæœ¬çš„ç›¸äº’ä¾èµ–çš„é—®é¢˜

### é‚£ä¹ˆè¿™æ ·çš„é‡å¤é—®é¢˜ä¼šå¸¦æ¥ä»€ä¹ˆåæœå‘¢ï¼Ÿ
- é¦–å…ˆ,ä¼šä½¿å¾—å®‰è£…çš„ç»“æœå æ®äº†å¤§é‡çš„ç©ºé—´èµ„æº,é€ æˆäº†èµ„æºçš„æµªè´¹
- åŒæ—¶,å› ä¸ºå®‰è£…çš„ä¾èµ–é‡å¤,ä¼šé€ æˆåœ¨å®‰è£…ä¾èµ–æ—¶,å®‰è£…æ—¶é—´è¿‡é•¿
- ç”šè‡³æ˜¯,å› ä¸ºç›®å½•å±‚çº§è¿‡æ·±,å¯¼è‡´æ–‡ä»¶è·¯å¾„è¿‡é•¿,ä¼šåœ¨`windows`ç³»ç»Ÿä¸‹åˆ é™¤`node_modules`æ–‡ä»¶,å‡ºç°åˆ é™¤ä¸æ‰çš„æƒ…å†µ

### ä½ åœ¨å®é™…çš„å¼€å‘ä¼šä¸ä¼šå‡ºç°è¿™æ ·çš„ä¸€äº›æƒ…å†µ
å½“ä½ é¡¹ç›®ä¾èµ–å‡ºç°é—®é¢˜çš„æ—¶å€™, æˆ‘ä»¬ä¼šä¸ä¼šæ˜¯ç›´æ¥åˆ é™¤`node_modules` å’Œ `lockfiles`ä¾èµ–, å†é‡æ–° `npm install`,åˆ é™¤å¤§æ³•æ˜¯å¦çœŸçš„å¥½ç”¨?è¿™æ ·çš„ä½¿ç”¨æ–¹æ¡ˆä¼šä¸ä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜ï¼Ÿ

æŠŠæ‰€æœ‰çš„ä¾èµ–åŒ…éƒ½å®‰è£…åˆ°`dependencies`ä¸­,å¯¹`devDependencies` ä¸åŒºåˆ†ä¼šä¸ä¼šæœ‰é—®é¢˜?

ä¸€ä¸ªé¡¹ç›®ä¸­, ä½ ä½¿ç”¨ `yarn`, æˆ‘ä½¿ç”¨`npm`ï¼Œä¼šä¸ä¼šæœ‰é—®é¢˜å‘¢ï¼Ÿ

è¿˜æœ‰ä¸€ä¸ªé—®é¢˜, `lockfiles æ–‡ä»¶` æˆ‘ä»¬æäº¤ä»£ç çš„æ—¶å€™éœ€ä¸éœ€è¦æäº¤åˆ°ä»“åº“ä¸­å‘¢ï¼Ÿ

## ç›®æ ‡

```
ç»™ä½ å’Œä½ çš„å›¢é˜Ÿã€ä½ çš„å…¬å¸å¸¦æ¥æœ€å¥½çš„å¼€æºåº“å’Œä¾èµ–ã€‚
é€šè¿‡è¿™å¥è¯,æˆ‘ä»¬å¯ä»¥äº†è§£åˆ° npm æœ€é‡è¦çš„ä¸€ç‚¹å°±æ˜¯å®‰è£…å’Œç»´æŠ¤ä¾èµ–ã€‚
```

## å®‰è£…æœºåˆ¶

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4fbc0e4e27c14500a2a9e4fcf4757fae~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp?)



`npm install`æ‰§è¡Œä¹‹å, é¦–å…ˆä¼šæ£€æŸ¥å’Œè·å– `npmçš„é…ç½®`,è¿™é‡Œçš„ä¼˜å…ˆçº§ä¸º:

```
é¡¹ç›®çº§çš„.npmrcæ–‡ä»¶ > ç”¨æˆ·çº§çš„ .npmrcæ–‡ä»¶ > å…¨å±€çº§çš„ .npmrc > npmå†…ç½®çš„ .npmrc æ–‡ä»¶
```

## å‚è€ƒèµ„æ–™

- [npm-å®˜ç½‘](https://www.npmjs.com/)

- [npm-æ˜é‡‘](https://juejin.cn/post/6844903870578032647)

- [npm å’Œ yarn ä½ é€‰å“ªä¸ªï¼Ÿ](https://juejin.cn/post/6844904030741921800)